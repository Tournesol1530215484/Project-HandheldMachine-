{template 'common/header'}
<title>退款信息</title>
<link rel="stylesheet" type="text/css" href="<?php echo MODULE_URL.'static/css/mui.min.css';?>">
<script type="text/javascript" src="../addons/sz_yi/static/js/mui.min.js"></script>
<style type="text/css">
    html{
        font-size: 10px;
    }
    body{
        background: #fff;
    }
    #big_body{width:100%;margin:0px;}
    .page_topbar{
       background: #009BF8;
    }
    .page_topbar a.back{
        font-family:serif,"PingFang SC", Helvetica, "Helvetica Neue", "微软雅黑", Tahoma, Arial, sans-serif;
        font-weight: bold;
        padding-right: 15px;
        color: #fff;
    }
    .page_topbar .title{
        color: #fff;
    }
    /*flex居中*/
    .flex-center {
        display: -webkit-box;
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
    }

    .list-box{
        margin-top: 10px;
        margin-bottom: 20px;
    }
    .no-list{
        text-align: center;
        color: #999;
    }
    .list-box .list-hd{
        font-size: 14px;
        color: #999;
        padding: 10px;
        border-bottom: 1px dashed #eee;
        font-weight: 600;
    }
    .list-hd .list-hd-na,
    .list-hd .list-hd-mo,
    .list-hd .list-hd-sta,
    .list-hd .list-hd-op,
    .list-hd .list-hd-op1,
    .status-mark-1,
    .status-mark,
    .list-box .list-ul .mobile-link{
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .list-box .list-ul .list-item{
        padding: 10px;
        border-bottom: 1px solid #eee;
        font-size: 1.2rem;
    }
    .list-box .list-ul .mobile-link{
        display: block;
        text-decoration: none;
        color: #000;
    }
    .list-box .list-ul .mobile-link:visited,
    .list-box .list-ul .mobile-link:active{
        color: #000;
    }
    .list-box .list-ul .list-item .floatl,
    .list-hd .list-hd-na{
        width: 55px;
        margin-right: 10px;
    }
    .list-box .list-ul .list-item .floatr,
    .list-hd .list-hd-mo{
        width: calc(100% - 245px);
    }
    .list-box .list-ul .list-item .floatr2,
    .list-hd .list-hd-sta{
        margin-left: 10px;
        width: 60px;
        text-align: center;
    }
    .list-box .list-ul .list-item .floatr3,
    .list-hd .list-hd-op{
        margin-left: 10px;
        width: 60px;
        text-align: center;
    }
    .list-box .list-ul .list-item .floatr4,
    .list-hd .list-hd-op1{
        margin-left: 10px;
        width: 80px;
        text-align: center;
    }
    .list-box .list-ul .show-tag{
        font-size: 1.2rem;
        color: #333;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .list-box .list-ul .mobile-link{
        font-size: 1.4rem;
    }
    #list_loading{ 
        width: 94%;
        padding: 10px;
        color: #666;
        text-align: center;
    }
    .status-mark-1{
        color: #ef4848;
    }
</style>
<div id="big_body">
    <div class="page_topbar">
        <a href="javascript:;" class="back" onclick="history.back()"><i class="fa fa-angle-left"></i></a>
        <div class="title">退款信息</div>
    </div>
    <div class="list-box">
        <ul class="list-hd flex-center">
            <li class="list-hd-item list-hd-na">姓名</li>
            <li class="list-hd-item list-hd-mo">手机号</li>
            <li class="list-hd-item list-hd-sta">状态</li>
            <li class="list-hd-item list-hd-op">报名费</li>
            <li class="list-hd-item list-hd-op1">退款时间</li>
        </ul>
        <ul class="list-ul">  
            <!-- 这里循环退款信息记录 或者 退款信息记录暂无数据为空 两种选择-->
            <!-- 这里循环退款信息记录 或者 退款信息记录暂无数据为空end -->
        </ul> 
    </div>
</div>
<!-- 两种模板 退款信息记录 或者 退款信息记录暂无数据为空 -->
<script id="tpl_list" type="text/html">
    <%each list as g%>
        <li class="list-item clearfloat">
            <div class="clearfloat flex-center">
                <div class="show-tag floatl"><%g.info.realname.data%></div><!-- 姓名 -->
                <div class="content-box floatr"> 		  		 	 	 	 	 
                    <!-- href也要赋值上电话号码 -->
                    <a href="tel:<%g.info.mobile.data%>" class="mobile-link"><!-- 手机号-->
                        <%g.info.mobile.data%>       
                    </a> 
                </div>
                <div class="status-box floatr2"><!-- 状态 -->
                    <%if g.paystatus == 0%>
                        <span class="status-mark-1">未付款</span>
                    <%else if g.paystatus == 1%>
                        <span class="status-mark-1">已付款</span>
                    <%else if g.paystatus == 2%>
                        <span class="status-mark-1">已退款</span>
                    <%/if%>
                </div>
                <div class="status-box floatr3"><!-- 报名费用 -->
                    <%g.money%>元
                </div>
                <div class="status-box floatr4"><!-- 退款时间 -->    
                    <%g.refundtime%> 
                </div>
            </div>
        </li>
    <%/each%>
</script>
<script id="tpl_null" type="text/html">
    <div class="no-list">暂无更多的列表</div>
</script>
<script type="text/javascript">
    var page = 1; 
    require(['tpl', 'core'], function(tpl, core) {
        core.pjson('activity/activity', {page:page,op:'refund',ac:'getRefund',id:'{$_GPC["id"]}'}, function(json) {    
            if (json.result.list.length <= 0) {
                $(".list-box .list-ul").html(tpl('tpl_null'));
                return;
            }
            //console.log(typeof(json.result.list[0].data));
            $(".list-box .list-ul").html(tpl('tpl_list',json.result));
            $('.list-box .list-ul').append('<div id="list_loading" class="getmore">点击加载更多</div>');
            var loaded = false;
            var stop=true; 
            getmore(page,loaded,stop);
        }, true);
        function getmore(page,loaded,stop){
            $(".getmore").unbind("click").click(function(){ 
                if(loaded){
                    return;
                }
                if(stop==true){ 
                    stop=false; 
                    page++;
                    core.pjson('activity/activity', {page:page,op:'refund',ac:'getRefund',id:'{$_GPC["id"]}'}, function(morejson) {   	 
                        stop = true;                
                        $('#list_loading').remove();         	 		 				 	 	
                        $(".list-box .list-ul").append(tpl('tpl_list', morejson.result));	 	 	 	 	 	 
                        //到时候返回数据用下面这种数据结构      
                        if (morejson.result.list.length < morejson.result.pagesize || morejson.result.list.length == 0) {
                            $('.list-box .list-ul').append('<div id="list_loading">已经加载全部列表</div>');
                            loaded = true;
                            return;
                        }else{
                            $('.list-box .list-ul').append('<div id="list_loading" class="getmore">点击加载更多</div>');
                            getmore(page,loaded,stop);
                        }
                    },true); 
                } 
            });
        }
    });
</script>
{template 'common/footer'}