{template 'common/header'}
{if $op == 'edit'}
    <title>修改资料</title>
    <style type="text/css">
		body{background:#fff;}
    	.customer_top {height:44px; width:100%;  background:#009BF8;  border-bottom:1px solid #ccc;}
	    .customer_top .title {height:44px; width:auto;margin-left:10px; float:left; font-size:16px; line-height:44px; color:#fff;}
	    .customer_top .title1{height: 44px;line-height: 44px;display: inline-block;width: 70%;text-align: center;color:#fff;font-size:16px;}
		.back{width: 18px;height: 19px;font-size: 22px;border-radius: 50%;float: left;line-height: 44px; font-family:serif,"PingFang SC", Helvetica, "Helvetica Neue", "微软雅黑", Tahoma, Arial, sans-serif;font-weight: bold;}
		.content{width: 100%;height: auto;padding-bottom: 10px;}
		.content .img{width: 120px;height: 140px;background: #fff;margin: 0 auto;padding-top:15px;} 
		.content .img>img{width:120px;}
		.inputLi{width: 98%;height: auto;background: #fff;margin: 0 auto;border-radius: 8px;padding: 13px;}
		.inputLi>span{display: block;height: 52px;font-size: 1.5em;line-height:40px;text-align:center;width:100%;padding:0;}
		.inputLi>p{border: 1px solid #3A3A3A;border-radius: 20px;height: 35px;line-height: 30px;text-indent: 12px;width: 100%;}
		.inputLi>p:nth-child(3)>span,.inputLi>p:nth-child(5)>span,.inputLi>p:nth-child(6)>span{letter-spacing: 0.37em;}
		.inputLi p input{border: 0;color: #ccc;margin-left: 6px;width: auto;height:33px;}
		input:focus{outline:none;}
		.submit{width: 50%;background:#009BF8 ;border-radius: 24px;margin: 0 auto;text-align: center;padding: 7px;font-size: 1.3em;margin-top: 30px;}
		.submit input{border: 0;background: none;color: #fff;}
    </style>
    <div class="customer_top">
		<div class="title" onclick='history.back()'><span class="back">&lt;</span>返回</div>
		<div class="title1">
			修改资料
		</div>
	</div>
    <!--<center><h4>{$info['username']}</h4></center>-->
    <div class="content">
    	<div class="img">
			<img src="../addons/sz_yi/plugin/suppliermenu/template/mobile/default/images/edinfo.png" />
		</div>
    	<div class="inputLi">
    		<span>PERSONAL INFOMATION</span>
    		<p>真实姓名：<input type="text" value="{$info['realname']}" name="realname"></p>
    		<p><span>手机</span>号：<input type="text" value="{$info['mobile']}" name="mobile"></p>
    		<p>银行卡号：<input type="text" value="{$info['banknumber']}" name="banknumber"></p>
    		<p><span>开户</span>行：<input type="text" value="{$info['accountbank']}" name="accountbank"></p>
    		<p><span>开户</span>名：<input type="text" value="{$info['accountname']}" name="accountname"></p>
	        <div class="submit">
	    		 <input type="submit" name="确认修改" value="确认修改">
	    	</div>   
    	   
    	</div>
    	
	       
    </div>
   
    <script>
        require(['core'], function( core) {
            $('input[type="submit"]').click(function(){
                var data = {
                    op:'edit',
                    'realname'    : $('input[name="realname"]').val(),
                    'mobile'      : $('input[name="mobile"]').val(),
                    'banknumber'  : $('input[name="banknumber"]').val(),
                    'accountbank' : $('input[name="accountbank"]').val(),
                    'accountname' : $('input[name="accountname"]').val()
                };
                core.pjson('suppliermenu/info', data, function(json) {
                    if (json.status == 1) {
                        alert('修改成功！');
                        window.location.href="{php echo $this->createPluginMobileUrl('suppliermenu/index')}";
                    } else if (json.status == 0) {
                        core.tip.show(json.result);
                    }
                }, true);
            });
        });
    </script>
{elseif $op == 'editpwd'}
    <title>修改密码</title>
    <style type="text/css">
		body{background:#fff;}
    	.customer_top {height:44px; width:100%;  background:#009BF8;  border-bottom:1px solid #ccc;}
	    .customer_top .title {height:44px; width:auto;margin-left:10px; float:left; font-size:16px; line-height:44px; color:#fff;}
	    .customer_top .title1{height: 44px;line-height: 44px;display: inline-block;width: 70%;text-align: center;color:#fff;font-size:16px;}
		.back{width: 18px;height: 20px;font-size: 22px;border-radius: 50%;float: left;line-height: 44px; font-family: serif,"PingFang SC", Helvetica, "Helvetica Neue", "微软雅黑", Tahoma, Arial, sans-serif;font-weight: bold;}
		.content{width: 100%;height: auto;padding-bottom: 10px;}
		.content .img{width: 120px;height: 140px;background: #fff;margin: 0 auto;padding-top:15px;} 
		.content .img>img{width:120px;}
		.inputLi{width: 98%;height: auto;background: #fff;margin: 0 auto;border-radius: 8px;padding: 13px;}
		.inputLi>span{display: block;height: 52px;font-size: 1.6em;;line-height:40px;text-align:center;}
		.inputLi>p{border: 1px solid #3A3A3A;border-radius: 20px;height: 35px;line-height: 30px;text-indent: 12px;width: 100%;}
		.inputLi>p:nth-child(2)>span,.inputLi>p:nth-child(3)>span{letter-spacing: 0.37em;}
		.inputLi p input{border: 0;color: #ccc;margin-left: 6px;width: auto;height:33px;}
		input:focus{outline:none;}
		.submit{width: 50%;background:#009BF8 ;border-radius: 24px;margin: 0 auto;text-align: center;padding: 7px;font-size: 1.3em;margin-top: 30px;}
		.submit input{border: 0;background: none;color: #fff;}
		
    </style>
    <div class="customer_top">
		<div class="title" onclick='history.back()'><span class="back">&lt;</span>返回</div>
		<div class="title1">
			修改密码
		</div>
	</div>
	<div class="content">
    	<div class="img">
			<img src="../addons/sz_yi/plugin/suppliermenu/template/mobile/default/images/edpsw.png" />
		</div>
    	<div class="inputLi">
    		<span>CHANGE PASSWORD</span>
    		<p><span>旧密</span>码：<input type="password"  name="oldpwd"></p>
    		<p><span>新密</span>码：<input type="password" name="newpwd1"></p>
    		<!-- <p><span>手机</span>号：   <input type="password" placeholder="请输入手机号码" name="phone"></p> -->
    		<p><span>重复密码</span>：<input type="password" name="newpwd2"> </p>
    		
	        <div class="submit">
	    		 <input type="submit" name="确认修改" value="确认修改">
	    	</div>   
    	</div>   
    </div>
    
    <script>
        require(['core'], function( core) {
            $('input[type="submit"]').click(function(){
                var data = {
                    op:'editpwd',
                    'oldpwd'  : $('input[name="oldpwd"]').val(),
                    'newpwd1' : $('input[name="newpwd1"]').val(),
                    'newpwd2' : $('input[name="newpwd2"]').val()
                };
                return false;
                console.log(data);
                core.pjson('suppliermenu/info', data, function(json) {
                    console.log(json);
                    if (json.status == 1) {
                        alert('修改成功！');
                        window.location.href="{php echo $this->createPluginMobileUrl('suppliermenu/index')}";
                    } else if (json.status == 0) {
                        core.tip.show(json.result);
                    }
                }, true);
            });
        });
    </script>
{elseif $op == 'editstore'}
<title>我的店铺</title>
<style type="text/css">
    
    body { margin: 0px; background: #eee;width: 100%; font-family: '微软雅黑'; -moz-appearance: none; overflow-x: hidden;}
    a { text-decoration: none; }
    .customer_top {height:44px; width:100%;  background:#10BDFF;  border-bottom:1px solid #ccc;overflow: hidden;}
    .customer_top .title {height:44px; width:auto; float:left; font-size:16px; line-height:44px; color:#fff;}
    .back{width: 30px;height: 30px;font-size: 24px;border-radius: 50%;float: left;line-height: 33px;text-align: center;margin: 5px; font-family: arial, helvetica, sans-serif;}
    .log_top { height: 44px; width: 100%; background: #f8f8f8; border-bottom: 1px solid #e3e3e3; }
    .log_top .title { height: 44px; width: auto; margin-left: 10px; float: left; font-size: 16px; line-height: 44px; color: #666; }
    .log_menu { height: 44px; background: #fff; }
    .log_menu .nav { height: 44px; width: 20%; border-bottom: 1px solid #f1f1f1; background: #fff; border-left: 1px solid #f1f1f1; float: left; line-height: 44px; font-size: 14px; color: #666; text-align: center; }
    .log_menu .navon { color: #00c1ff; border-bottom: 2px solid #00c1ff; }
    .log_title { height: 40px; padding: 5px; line-height: 50px; font-size: 16px; color: #666; }
    .log_list { height: 60px; padding: 10px; background: #fff; margin-top: 5px; }
    .log_list .left { height: 40px; width: 100%; float: left; color: #999; margin-right: -20%; font-size: 14px; }
    .log_list .left .inner { width: 100%; margin-right: -20% }
    .log_list .left span { color: #666; font-size: 13px; line-height: 28px; }
    .log_list .right { height: 40px; width: 30%; float: right; font-size: 14px; text-align: right; line-height: 18px; margin-left: -20%; }
    .log_list .right span { color: #f90; }
    .log_no { height: 100px; width: 100%; margin: 50px 0px 60px; color: #ccc; font-size: 12px; text-align: center; }
    #coupon_loading { padding:10px;color:#666;text-align: center;}
    #container{width: 100%;height: auto;background: #fff;margin-top: 12px;    padding-bottom: 20px;overflow-x: hidden;}
    .center{width: 96%;margin: 0 auto;}
    .center .title{font-size: 16px;border-bottom: 1px solid #ccc;padding: 10px;}
    .center .title input{border: 0;margin-left: 20px;}
    .center .portrait{font-size: 16px;height:124px;line-height: 88px;padding: 10px;width: 100%;border-bottom: 1px solid #E4E4E4;}
    .img{width:26px;height:30%;margin: 0 auto;height: 30%;}
    .img img{width: 100%;height: 100%;}
    .center .signs{font-size: 16px;height: 124px;line-height: 88px;padding: 10px;width: 100%;border-bottom: 1px solid #E4E4E4;}
    .upload-img1 {width: 100px;height: 100px;background: #E6E6E6;float:left;text-align: center;margin-left: 20px;position: relative;}
    
    .upload-img {width: 197px;height: 100px;background: #E6E6E6;float:left;text-align: center;margin-left: 20px;position: relative;}
    .share{font-size: 16px;color: #ccc;height: 60px;width: 100%;margin: 20px auto;height: 120px;}
    textarea{width: 100%;height: 100%;border: 1px solid #ccc;}
    text{margin-bottom: 20px;}
    .confirm{width: 40%;height: 40px;background: #10BDFF;color: #fff;font-size: 16px;margin: 0 auto;text-align: center;border-radius: 14px;line-height: 40px;margin-top: 20px;}
    .upload-img1 input{display:inline-block;position: absolute;left: 0px;width: 100px;height: 100px;top:0px;opacity: 0;}
    .upload-img input{display:inline-block;position: absolute;left: 0px;width: 197px;height: 100px;top:0px;opacity: 0;}
    .imgclass{width: 100%;height: 100%;}
</style>  
<div class="customer_top">
    <div class="title" onclick='history.back()'><span class="back"><</span>返回<p style="display: inline-block;margin-left: 76px;">我的店铺</p></div>
</div>
<form>
    <input type="hidden" name="role" id="role" value="{$_GPC['merch']}" />
    <div id='container'>
        <div class="center">
            <div class="title">
                小店名称:
                <input type="text" name="" id="storename" value="{$storeData['storename']}" />
        </div>
            <div class="portrait">
                <div style="float: left;">小店头像:</div>
                <div class="upload-img1 ">
                    <p class="img"><img class="imgclass" src="/addons/sz_yi/plugin/suppliermenu/template/mobile/default/images/plus.png" /></p>
                    <text>添加图片</text>
                    <input type="file" name="logoimg" id="logo" value="" />
                    <input type="hidden" name="logo" value="{$storeData['logo']}" />
                </div>
            </div>
            <div class="signs">
                <div style="float: left;">小店店招:</div>
                <div class="upload-img ">
                    <p class="img"><img class="imgclass" src="/addons/sz_yi/plugin/suppliermenu/template/mobile/default/images/plus.png" /></p>
                    <text>添加图片</text>
                    <input type="file" name="signboardimg" id="signboard" value="" />
                    <input type="hidden" name="signboard" value="{$storeData['signboard']}" />
                </div>
            </div>
            <div class="share">
                <textarea name="description" id="description" rows="" cols="" placeholder="小店简介，分享你的小店">{$storeData['description']}</textarea>
            </div>
        </div>
        <div class="confirm">
            确认修改
        </div>
    </div>
</form>

<script src="../addons/sz_yi/static/js/dist/ajaxfileupload.js" type="text/javascript"></script>

<script type="text/javascript">

require(['tpl', 'core'], function(tpl, core) {
    var logo = "{$storeData['logo']}";
    var signboard = "{$storeData['signboard']}";
    if (logo) {
        var img = document.createElement("img");
        img.src = '../attachment/'+logo;
        img.className='imgclass';
        $('.upload-img1 p').remove();
        $('.upload-img1 text').remove();
        $(".upload-img1").append( img );
    }
    if (signboard) {
        var img = document.createElement("img");
        img.src = '../attachment/'+signboard;
        img.className='imgclass';
        $('.upload-img p').remove();
        $('.upload-img text').remove();
        $(".upload-img").append( img );
    }
    $('#logo').change(function() {
        core.loading('正在上传');
        console.log('test');
        $.ajaxFileUpload({
            url: core.getUrl('util/uploader'),
            data: {file: "logoimg"},
            secureuri: false, 
            fileElementId: 'logo', 
            dataType: 'json', 
            success: function(res, status) {
                console.log(res);
                core.removeLoading();
                var img = document.createElement("img");
        		img.src = res.url;
        		img.className='imgclass';
                $('.upload-img1 .imgclass').remove();
                $('input[name="logo"]').val(res.filename); // 把上传成功后的地址写入隐藏域
                $('.upload-img1 p').remove();
                $('.upload-img1 text').remove();
                $(".upload-img1").append( img );
            }, error: function(data, status, e) {
                core.removeLoading();
                core.tip.show('上传失败!');
            }
        });
    });
    /*图片上传*/
	
	$('#signboard').change(function(){
		core.loading('正在上传');
        console.log('test');
        $.ajaxFileUpload({
            url: core.getUrl('util/uploader'),
            data: {file: "signboardimg"},
            secureuri: false, 
            fileElementId: 'signboard', 
            dataType: 'json', 
            success: function(res, status) {
                console.log(res);
                core.removeLoading();
                var img = document.createElement("img");
        		img.src = res.url;
        		img.className='imgclass';
                $('.upload-img .imgclass').remove();
                $('input[name="signboard"]').val(res.filename); // 把上传成功后的地址写入隐藏域
                $('.upload-img p').remove();
                $('.upload-img text').remove();
                $(".upload-img").append( img );
            }, error: function(data, status, e) {
                core.removeLoading();
                core.tip.show('上传失败!');
            }
        });
	});

    $('.confirm').click(function(){

        var role = $('input[name="role"]').val();
        var logo = $('input[name="logo"]').val();
        var signboard = $('input[name="signboard"]').val();
        var description = $('#description').val();
        var description = $('#description').val();
        var storename = $('#storename').val();

        core.pjson('suppliermenu/info', {
            op : 'editstore',
            logo : logo,
            signboard : signboard,
            description : description,
            storename : storename,
            role : role
        }, function(json) {
            console.log(json);
            if (json.status == 1) {
                core.tip.alert('修改成功！');
            } else if (json.status == 0) {
                core.tip.show(json.result);
            }
        }, true);
    });
});		
	
</script>
{/if}
{php $show_footer=true}
{php $footer_current='member'}
{template 'common/footer'}