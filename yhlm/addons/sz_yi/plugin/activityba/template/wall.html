{template 'mycommon/header-intact'}
<script type="text/javascript" src="../addons/sz_yi/plugin/activityba/res/js/index.js"></script>
<title>{if $act['title']}{$act['title']}{else}暂无活动名称{/if}</title>
<style type="text/css">
	html,body{
		width: 100%;	 	 			
	}
	body{
		font-size: 10px;
		/*背景图这里动态赋值*/
		{if $act['background']}
		background: #000 url({php echo tomedia($act['background'])}) no-repeat center;
		{else}
		background: #000 url(http://jhzh66.com/attachment/images/8/2018/11/t0VN3PP99KZ9W9WEApPaqD740tOEkY.jpg) no-repeat center;
		{/if}
		background-size: 100% 100%;
		overflow: auto;
	}
	.m-container{
		width: 960px;	 		 	
	    margin: 0 auto;
	    position: relative;
	}
	.m-container.fixed {
	    position: absolute;
	    top: 50%;
	    left: 50%;
	    margin-top: -384px;
	    margin-left: -480px;
	}
	.m-container .top-box{
		height: 80px;
	    margin-top: 20px;
	    background-color: rgba(255,255,255,.2);
	}
	.m-container .top-box .fl-box{
		float: left;
		height: 100%;
	}
	.m-container .top-box .fl-box .img{
		width: 80px;
		height: 80px;
	} 
	.m-container .top-box .l-box{
	    width: 130px;
	}
	.m-container .top-box .c-box{
	    width: 600px;
	    text-align: center;
	    overflow: hidden;
	}
	.m-container .top-box .c-box .title-box{
		line-height: 40px;
	    color: #ffd700;
	    font-size: 20px;
	    font-weight: bold;
	    display: -webkit-box;
	    -webkit-line-clamp: 2;
	    -webkit-box-orient: vertical;
	    overflow: hidden;
	}
	.m-container .top-box .r-box{
	    width: 230px;
	    text-align: right;
	}
	.m-container .top-box .r-box .tipword{
	    display: inline-block;
	    width: 100px;
	    height: 100%;
	    text-align: center;
	    vertical-align: top;
	    margin-top: 7px;
	}
	.hidden-box{
		display: none!important;
	}
	.m-container .top-box .tipword .num {
	    font-weight: bold;
	    font-size: 25px;
	    color: white;
	}
	.m-container .top-box .tipword .plus {
	    font-size: 17px;
	    color: white;
	}
	.m-container .top-box .r-box .r-qrcode{
		margin-left: 28px;
	    cursor: pointer;
	}
	.m-container .main-box{
	    position: relative;
	    height: 463px;
	    margin-top: 20px;
	    z-index: 1050;
	}
	.m-container .main-box iframe {
	    border: 0;
	}
	.m-container .notice-box{
	    height: 50px;
	    margin-top: 20px;
	    border: 1px solid rgba(255,255,255,.2);
	    background-color: rgba(255,255,255,.1);
	}
	.m-container .notice-box .icon{
	    display: inline-block;
	    height: 50px;
	    width: 50px;
	    margin-left: 13px;
	    line-height: 50px;
    	vertical-align: top;
    	text-align: center;
	}
	.m-container .notice-box .icon i{
		color: #fff;
		font-size: 44px;
		padding: 2px 0;
	}
	.m-container .notice-box .word {
	    display: inline-block;
	    height: 50px;
	    overflow: hidden;
	}
	.m-container .notice-box .word .scroll {
	    display: inline-block;
	    transition: all 1s;
	    -webkit-transition: all 1s;
	    -moz-transition: all 1s;
	}
	.m-container .notice-box .word .scroll .s-content{
	    color: white;
	    font-size: 25px;
	    line-height: 50px;
	    vertical-align: top;
	    width: 858px;
	    display: inline-block;
	    margin-left: 13px;
	    overflow: hidden;
	    white-space: nowrap;
	    text-overflow: ellipsis;
	}
	.bottom-box{
		margin-top: 25px;
	}
	.bottom-box .toggle-box{
		width: 100%;
		margin: 0 auto;
		text-align: center;
		border-bottom: 2px solid rgba(255,255,255,.2);
		margin-bottom: 5px;
	}
	.bottom-box .toggle-box .toggle-icon{
		display: inline-block;
		width: 50px;
		height: 50px;
	}
	.bottom-box .toggle-box .toggle-icon i{
		color: #fff;
		font-size: 50px;
	}
	.m-container .bottom-box .func-box{
	    text-align: center;
	}
	.m-container .bottom-box .func-box .func-ul{
		display: inline-block;
	}
	.m-container .bottom-box .func-box .func-ul .func-item{
	    float: left;
	    margin: 5px 18px;
	    cursor: pointer;
	}
	.m-container .bottom-box .func-box .func-ul .func-item .icon {
	    display: inline-block;
	    width: 30px;
	    height: 30px;
	    margin-bottom: 6px;
	}
	.m-container .bottom-box .func-box .func-ul .func-item .icon i{
		color: #fff;
		font-size: 28px;
	}
	.m-container .bottom-box .func-box .func-ul .func-item .text {
	    color: white;
	    font-size: 12px;
	}
</style>
<div class="m-container">
	<div class="top-box clearfloat">
		<!-- 公司logo -->
		<div class="l-box fl-box">
			{if $act['companyLogo']}
				<img class="logo img" src="{php echo tomedia($act['companyLogo'])}">
			{else}

			{/if}
		</div>
		<!-- 活动标题 -->
		<div class="c-box fl-box">
			<div class="title-box">{$act['theme']}</div>
		</div>	 	 	 	 
		<!-- 二维码 -->
		<div class="r-box fl-box">
			<span class="tipword messageword ">
                <span class="num" id="msgnum">{$msgtotal}</span><br>
                <span class="plus">条消息</span>               
            </span>
            <span class="tipword signword hidden-box">
                <span class="num" id="signinnum">{$sgtotal}</span><br>
                <span class="plus">人签到</span>               
            </span>
            <!-- 二维码 链接何处? -->
			<img class="r-qrcode img" src="{$qrcode}">
		</div>
	</div>
	<div class="main-box">	 	 	
		<iframe class="m-iframe" name="subpage" src="http://jhzh66.com/web/index.php?c=site&a=entry&method=wall&p=activityba&do=plugin&m=sz_yi&op=msg" width="100%" height="100%"></iframe>
	</div>
	<div class="notice-box">
		<span class="icon"><i class="fa fa-volume-up" aria-hidden="true"></i></span>
        <span class="word">
            <span class="scroll live-box">
            	<!-- 循环类为s-content的span 和 br换行元素 -->
            	<!-- 循环 s -->
            	{if 0}
                <span class="s-content">
                	嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎嘎1
                </span><br>
                <!-- 循环 e -->
                <span class="s-content">
                	嘎嘎2
                </span><br>
                <span class="s-content">
                	嘎嘎3
                </span><br>	 	
                {/if} 
            </span>		 		
        </span> 	 
	</div>
	<div class="bottom-box">
		<div class="toggle-box" data-on="1">
			<span class="toggle-icon"><i class="fa fa-angle-down mark-icon" aria-hidden="true"></i></span>
		</div>
		<div class="func-box">
			<ul class="func-ul clearfloat">
				<li class="func-item full-screen-off" title="全屏">
                    <span class="icon screen"><i class="fa fa-arrows-alt" aria-hidden="true"></i></span><br>
                    <span class="text">全屏</span>
                </li>
                <li class="func-item full-screen-on hidden-box" title="取消全屏">
                    <span class="icon exit_screen"><i class="fa fa-window-close-o" aria-hidden="true"></i></span><br>
                    <span class="text">退出全屏</span>
                </li>
                <li class="func-item" title="显示二维码" page="qrcode">
                    <span class="icon qrcode"><i class="fa fa-qrcode" aria-hidden="true"></i></span><br>
                    <span class="text">二维码</span>
                </li>
                <li class="func-item" title="显示消息墙" page="msg">
                    <span class="icon message"><i class="fa fa-comments-o" aria-hidden="true"></i></span><br>
                    <span class="text">消息墙</span>
                </li>
                <li class="func-item" title="签到墙" page="signin">
                    <span class="icon sign"><i class="fa fa-edit" aria-hidden="true"></i></span><br>
                    <span class="text">签到墙</span>
                </li>
                <li class="func-item" title="抽奖" page="lottery">
                    <span class="icon wheel"><i class="fa fa-gift" aria-hidden="true"></i></span><br>
                    <span class="text">抽奖</span>
                </li>
			</ul>
		</div>
	</div>
</div>
<!-- 直播台信息模板 -->
<script id="tpl_live" type="text/html">
	<span class="s-content">
       	<%msg%>
    </span><br>
</script>
<script type="text/javascript">
	var keyword="";
	var qrcode="";	 	   	 	
	var pageGap="5";
	require(['tpl', 'core'], function(tpl, core) {
		$(function(){
			qrcode=$(".r-qrcode").attr("src");
			var d = $(".m-iframe");
			$(".func-item").click(function(){
				var j = $(this).attr("page");
				if (j) {
					//二维码页面链接
	                if(j=="qrcode"){
	                    d.attr("src", "http://jhzh66.com/web/index.php?c=site&a=entry&method=wall&p=activityba&do=plugin&m=sz_yi&op=qrcode");
	                }
	                //消息墙页面链接
	                if(j=="msg"){
	                    $(".signword").addClass('hidden-box');
	                    $(".messageword").removeClass('hidden-box');
	                    d.attr("src", "http://jhzh66.com/web/index.php?c=site&a=entry&method=wall&p=activityba&do=plugin&m=sz_yi&op=msg");
	                }
	                //签到墙页面链接
	                if(j=="signin"){
	                    $(".signword").removeClass('hidden-box');
	                    $(".messageword").addClass('hidden-box');
	                    d.attr("src", "http://jhzh66.com/web/index.php?c=site&a=entry&method=wall&p=activityba&do=plugin&m=sz_yi&op=signin");
	                }
	                //抽奖页面链接
	                if(j=="lottery"){
	                    d.attr("src", "http://jhzh66.com/web/index.php?c=site&a=entry&method=wall&p=activityba&do=plugin&m=sz_yi&op=lottery");
	                }
	            }
			});
			$(".toggle-box").click(function(){
				$(".func-box").toggle();
				if($(this).data("on") == 1){
					$(this).data("on",'');
					$(".mark-icon").addClass("fa-angle-up").removeClass("fa-angle-down");
					$(this).css("border-bottom",'0');
				}else{
					$(this).data("on",'1');
					$(".mark-icon").addClass("fa-angle-down").removeClass("fa-angle-up");
					$(this).css("border-bottom",'2px solid rgba(255,255,255,.2)');
				}
			});
			//直播台信息 只显示最新的那条信息 跟内置标签的直播信息有所区别 如果有新的直播台信息ret==1,否则等于0,一直显示最新的信息
			liveMsgPage=1;	 		 		 	  	 	
			setInterval(function(){
				core.pjson('activityba/wall', {op:'livemsg',page:liveMsgPage}, function(json){
					// json = {"ret":1,"msg":"bygg"};	 			 	 	
					if (json.ret == 1) {	 			
						liveMsgPage++; 				 	 	 	 		 	  		 	 		 	 				  	 	
	                    $(".live-box").html(tpl("tpl_live",json));
	                }/*else{	 			 		 
	                    core.tip.show(json.msg || "网络繁忙，请稍后重试！");
	                }*/	 		 		 	 	 			 		 	 	 	
				});	 		 
			},10000);

			//这个是打开后台窗口某个功能的链接
			$(".r-qrcode").click(function (){
		        var url="https://www.baidu.com/?tn=78040160_26_pg&ch=1";
		        var url=url+"?qrcode="+qrcode;
		        var url=url+"&keyword="+keyword;
		        window.open(encodeURI(url));
		    });
		});
	});
</script>
{template 'mycommon/footer-intact'}